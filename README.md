# Malware_Detection
This project is aimed at classifying android malware samples taken from a huge malware dataset into 14 prominent malware categories based on the similarity of their attributes such as memory, API, network, battery, logcat, process using machine learning models. For this I used the CCCS-CIC-AndMal-2020 Android malware dataset comprising of 200K benign and 200K malicious samples totaling 400K android apps, 14 significant malware categories, and 385 prominent malware families. Adware, backdoor, file infector, no category, potentially Unwanted Apps (PUA), ransomware, riskware, scareware, trojan, trojan-banker, trojan-dropper, trojan-sms, trojan-spy, and zero-day malware are among the 14 malware types collected for the dataset. To categorize Android malware, I used six types of dynamic parameters, including memory, API, network, logcat, battery, and process. The dataset contained a total of 28 csv files, among which 14 are for after reboot and 14 are for before reboot. 
"After reboot" and "before reboot" refer to two different states of a system or device. When a system is restarted or rebooted, it undergoes a fresh start, and all its components are reset. Thus, any issues or errors that were present before the reboot may be resolved, but new issues may also arise. Therefore, in the context of the given dataset, the 14 files labeled "before reboot" likely contain data collected before the system was rebooted, while the 14 files labeled "after reboot" likely contain data collected after the system was rebooted. The purpose of collecting data before and after the reboot could be to compare the performance or behavior of the system in both states.
The data was uploaded to the shared database in MySQL. To use MySQL in the project, a connection to the MySQL database can be established using Python libraries like mysql-connector-python.
After that cleaning and preprocessing of data was performed. Initially upon merging we had 25059 rows and 144 columns and after cleaning we had 24183 rows and 29 columns for after reboot. For before reboot we had 28380 rows and 144 columns and were left with 22124 rows and 29 columns.
After all the cleaning we saw that coincidently all the rows for the category ‘Zero_Day’ had either ‘unknown’ or ‘singleton’ as value in their ‘Family’ column so they all were dropped and hence now we only have 13 categories of malware to classify and not 14. As the machine learning models do not support strings, and they require input and output to be a numerical value, I encoded the ‘Category’ and ‘Family’ columns into numerical data; the encoded columns were named as ‘Category_en’ and ‘Family_en’. 
Next, I calculated the statistical significance of data using mutual information. Mutual information tells us how much information on average was communicated in one random variable about the other. In this case memory heap size can explain the label (i.e., Category variable) better because they share more mutual information. I applied 5 machine learning models on the dataset for classification: Support Vector Machine (SVM), Logistic Regression, Multi-Layer Perceptron (MLP), XGBoost, and Random Forest. The results of the predictions made by the models indicated that the MLP and XgBoost models have performed the best with respect to the F1 score metric.
**Folder specifications**
Data Files for after reboot version - contains 14 csv files for the 14 malware types for after reboot state
Data Files for before reboot version - contains 14 csv files for the 14 malware types for before reboot state
Merged csv for after reboot files - contains the merged csv which has all 14 malwrae types in one after cleaning and encoding
Merged csv for before reboot files - contains the merged csv which has all 14 malwrae types in one before cleaning and encoding
Code files - contains all the jupyter notebooks for visualization, SQL connection, and data proecessing, cleaning and encoding

